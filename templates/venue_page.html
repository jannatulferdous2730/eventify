{% extends "base.html" %} 
{% load static tailwind_tags %} 
{% block title %}Venue Details - Eventify{% endblock %} 

<style>
    .star {
        font-size: 24px;
    }

    .filled-star {
        color: gold;
    }

    .outlined-star {
        color: lightgray;
    }
</style>


{% block content %}

    <div class="bg-gray-100">
        <div class="container mx-auto px-4 py-8">
            <div class="flex flex-wrap -mx-4">
                <!-- Venue Images -->
                <div class="w-full md:w-1/2 px-4 mb-8">
                    <img src="{{ club.image.url }}" alt="Venue Image"
                        class="w-full h-96 rounded-lg object-cover shadow-md mb-4" id="mainImage">
                    <div class="flex gap-4 py-4 justify-center overflow-x-auto">

                        <img src="{{ club.image.url }}" alt="{{ club.name }}"
                        class="size-16 sm:size-20 object-cover rounded-md cursor-pointer opacity-60 hover:opacity-100 transition duration-300"
                        onclick="changeImage(this.src)">
                        
                        {% for image in club.images.all %}   
                        <img src="{{ image.image.url }}" alt="{{ club.name }}"
                        class="size-16 sm:size-20 object-cover rounded-md cursor-pointer opacity-60 hover:opacity-100 transition duration-300"
                        onclick="changeImage(this.src)">
                        {% endfor %}

                       
                        
                        
                    </div>
                </div>

                <!-- Venue Details -->

                <div class="w-full md:w-1/2 px-4">
                    <h2 class="text-3xl font-bold mb-2">{{ club.name }}</h2>
                    <p class="text-gray-600 mb-4">Location: <span class="font-semibold">{{ club.location }}</span></p>
                    <div class="mb-4">
                        <span class="text-2xl font-bold mr-2">৳{{ club.price_per_day }}/day</span>
                        <span class="text-gray-500 line-through">৳{{ club.old_price_per_day }}/day</span>
                    </div>
                    <p class="text-gray-700 mb-6">
                        {{ club.description }}
                    </p>

                    <!-- Key Features -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-2">Key Features:</h3>
                        <ul class="list-disc list-inside text-gray-700">
                            {{ club.features | safe }}
                        </ul>
                    </div>


                    <!-- Booking Options -->
                    <div class="mb-6">
                        <form method="post" action="{% url 'book' %}">
                            {% csrf_token %}
                            <input type="hidden" name="club_id" value="{{ club.id }}">
                            <input type="hidden" name="email" value="{{ club.user.email }}">
                            <!-- Replace 'venue.id' with actual venue ID -->
                            <label for="booking-date" class="block text-sm font-medium text-gray-700 mb-1">Select
                                Date:</label>
                            <input type="date" id="booking-date" name="booking_date"
                                class="w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                                <div>
                                    <h6 class="text-red-700 text-sm mt-4">You have to pay 30% in advance to book</h6>
                                </div>
                                <div class="flex space-x-4 mt-4">
                                    
                                {% if user.is_authenticated %}
                                
                                <button class="btn btn-primary text-white">
                                    Book Now
                                </button>
                                {% else %}
                                <a href="{% url 'login' %}" class="btn btn-primary text-white">Book Now</a>
                                {% endif %}
                                <button class="btn btn-outline">
                                    Schedule Visit
                                </button>
                            </div>
                    </div>
                    </form>
                </div>
            </div>

            <!-- Map Integration -->
            <div class="my-8">
                <h3 class="text-lg font-semibold mb-4">Location</h3>
                <div class="rounded-2xl overflow-hidden">
                    <iframe src="{{ club.map_url }}" width="100%" height="500" allowfullscreen=""
                        loading="lazy"></iframe>
                </div>
            </div>

            <br>
            <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
                <h3 class="text-2xl font-bold text-gray-900 mb-4">Leave a Review</h3>
                <h3>Leave a Review</h3>
                {% if user.is_authenticated %}
                <form method="post">
                    {% csrf_token %}
                    {{ review_form.as_p }}
                    <div class="pt-6">
                        <button type="submit" name="review_submit" class="btn btn-primary text-white">Submit Review</button>
                    </div>
                </form>
                {% else %}
                <p>You must <a href="{% url 'login' %}">log in</a> to leave a review.</p>
                <br>
                {% endif %}
            </div>

            <br>
            <br>
            <!-- Reviews Section -->
            <!-- Testimonial slider -->
            <div class="relative w-full glide-08">
                {% if reviews %}
                <!-- If reviews are present -->
                <div class="overflow-hidden text-center bg-white rounded shadow-2xl shadow-slate-200 text-slate-500"
                    data-glide-el="track">
                    <ul
                        class="relative w-full overflow-hidden p-0 whitespace-no-wrap flex flex-no-wrap [backface-visibility: hidden] [transform-style: preserve-3d] [touch-action: pan-Y] [will-change: transform]">
                        {% for review in reviews %}
                        <li class="w-full">
                            <div class="relative p-6">
                                <blockquote class="p-6 text-lg leading-loose lg:text-xl">
                                    <p>{{ review.content }}</p>
                                </blockquote>
                                <figcaption class="flex flex-col items-center gap-2 p-6 text-sm text-emerald-500">
                                    <span class="flex gap-1 text-amber-400" role="img" aria-label="Rating">



                                        <div class="rating">
                                            {% for i in "12345" %}
                                            {% if forloop.counter <= review.rating %}
                                            <span class="star filled-star">★</span>
                                            {% else %}
                                            <span class="star outlined-star">★</span>
                                            {% endif %}
                                            {% endfor %}
                                        </div>

                                    </span>

                                    <div class="flex items-center gap-4 pt-4 text-sm text-left text-emerald-500">
                                        <img src="https://i.pravatar.cc/40?img={{ review.rating }}" alt="user name"
                                            title="user name" width="48" height="48"
                                            class="max-w-full rounded-full shrink-0" />
                                        <div class="flex flex-col gap-1">
                                            <span class="font-bold uppercase">{{ review.user.email }}</span>
                                            <cite class="not-italic"><a
                                                    href="#">{{ review.positions }}</a></cite>
                                        </div>
                                    </div>
                                </figcaption>
                            </div>
                        </li>
                        {% endfor %}


                    </ul>
                </div>
                <!-- Indicators -->
                <div class="flex items-center justify-center w-full gap-2 pt-6" data-glide-el="controls[nav]">
                    {% for _ in reviews %}
                    <button class="p-4 group" data-glide-dir="={{ forloop.counter0 }}"
                        aria-label="goto slide {{ forloop.counter }}">
                        <span
                            class="block w-2 h-2 transition-colors duration-300 rounded-full opacity-70 ring-1 ring-slate-700 bg-white/20 focus:outline-none"></span>
                    </button>
                    {% endfor %}
                </div>
                {% else %}
                <!-- If no reviews -->
                <div class="text-center p-6 bg-white rounded shadow-2xl shadow-slate-200 text-slate-500">
                    <p>No reviews available at the moment. Be the first to leave a review!</p>
                </div>
                {% endif %}
            </div>

            <!-- Testimonial slider -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/Glide.js/3.0.2/glide.js"></script>

            <script>
                var glide07 = new Glide('.glide-08', {
                    type: 'slider',
                    focusAt: 'center',
                    perView: 1,
                    autoplay: 3500,
                    animationDuration: 700,
                    gap: 0,
                    classes: {
                        activeNav: '[&>*]:bg-slate-700',
                    },
                });

                glide07.mount();
            </script>
            <!-- End Testimonial slider -->




            <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-element-bundle.min.js"></script>

            <script>
                function changeImage(src) {
                    document.getElementById('mainImage').src = src;
                }
            </script>


{% endblock %}
